<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanesOS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tahoma', sans-serif;
        }
        
        body {
            overflow: hidden;
            background-color: #236B8E;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .desktop {
            flex: 1;
            background-image: url('https://dinkybeat.github.io/media/img/bliss.png');
            background-size: cover;
            background-position: center;
            position: relative;
            padding: 10px;
            overflow: hidden;
        }

        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(1, 70px);
            grid-gap: 20px;
            padding: 10px;
            position: relative;
            z-index: 10;
        }
        
        .icon {
            width: 70px;
            text-align: center;
            cursor: pointer;
        }
        
        .icon img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .icon-text {
            color: white;
            font-size: 11px;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.8);
            background-color: rgba(0, 0, 0, 0.2);
            padding: 2px;
            border-radius: 2px;
        }
        
        .taskbar {
            height: 30px;
            background: linear-gradient(to bottom, #1C57C2 0%, #2A8BE2 5%, #2989D8 50%, #2580C7 95%, #2277BC 100%);
            display: flex;
            align-items: center;
            padding: 0 2px;
            position: relative;
            z-index: 100;
            border-top: 1px solid #5D9FD5;
        }
        
        .start-button {
            display: flex;
            align-items: center;
            background: linear-gradient(to bottom, #3C8F00 0%, #5FBB4D 5%, #58B548 50%, #4AA838 95%, #3C8F00 100%);
            height: 28px;
            border-radius: 3px;
            margin-right: 10px;
            padding: 0 5px;
            cursor: pointer;
            box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.2);
        }
        
        .start-text {
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        
        .taskbar-divider {
            width: 1px;
            height: 20px;
            background-color: #1C57C2;
            margin: 0 5px;
        }
        
        .quick-launch {
            display: flex;
            align-items: center;
        }
        
        .taskbar-spacer {
            flex: 1;
        }
        
        .system-tray {
            display: flex;
            align-items: center;
            background-color: #0F80C4;
            height: 22px;
            padding: 0 5px;
            border-radius: 2px;
        }
        
        .time {
            color: white;
            font-size: 11px;
            margin-left: 5px;
        }
        
        /* Additional styling for a more authentic look */
        .icon.selected .icon-text {
            background-color: rgba(49, 106, 197, 0.4);
        }

        .taskbar-apps {
            display: flex;
            height: 28px;
            margin-left: 5px;
        }

        .taskbar-app {
            background: linear-gradient(to bottom, #2D91E3 0%, #2B8FDA 45%, #267ACD 55%, #2475C4 100%);
            border-radius: 2px;
            padding: 0 8px;
            margin-right: 3px;
            display: flex;
            align-items: center;
            cursor: pointer;
            max-width: 150px;
            color: white;
            font-size: 11px;
            box-shadow: inset 0 0 1px 1px rgba(255, 255, 255, 0.2);
        }
        
        /* Emoji styles */
        .emoji {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        a {
            text-decoration: none;
            color: inherit;
        }

        .start-emoji {
            font-size: 16px;
            margin-right: 3px;
        }

        .quick-launch-icon {
            font-size: 22px;
            margin-right: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .app-emoji {
            font-size: 16px;
            margin-right: 5px;
        }

        .tray-emoji {
            font-size: 16px;
            margin-left: 5px;
        }

        /* Common Window Styles */
        .window {
            position: absolute;
            background-color: #ECE9D8;
            border: 1px solid #0055EA;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            border-radius: 3px 3px 0 0;
            display: none;
        }

        .titlebar {
            height: 28px;
            background: linear-gradient(to right, #0058E6, #2686E0, #7EB6E7);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 8px;
            color: white;
            font-weight: bold;
            font-size: 13px;
            border-radius: 3px 3px 0 0;
            user-select: none;
        }

        .title {
            display: flex;
            align-items: center;
        }

        .title-emoji {
            margin-right: 6px;
            font-size: 16px;
        }

        .window-controls {
            display: flex;
        }

        .window-button {
            width: 21px;
            height: 21px;
            margin-left: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            border-radius: 3px;
        }

        .window-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .close-button {
            background-color: #FF4943;
            color: white;
            font-weight: bold;
        }

        /* Folder Window Styles */
        .folder-window {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 600px;
            height: 400px;
        }

        .folder-toolbar {
            height: 36px;
            background-color: #EBE8D8;
            border-bottom: 1px solid #D8D2BD;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }

        .folder-toolbar-section {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }

        .folder-toolbar-button {
            display: flex;
            align-items: center;
            font-size: 12px;
            padding: 4px 8px;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .folder-toolbar-button:hover {
            border: 1px solid #B1AEA0;
            background-color: #F7F5ED;
        }

        .folder-toolbar-emoji {
            margin-right: 3px;
            font-size: 14px;
        }

        .folder-addressbar {
            height: 24px;
            background-color: white;
            border: 1px solid #7F9DB9;
            margin: 5px 10px;
            display: flex;
            align-items: center;
            padding: 0 5px;
        }

        .folder-addressbar-label {
            font-size: 12px;
            margin-right: 5px;
        }

        .folder-addressbar-path {
            font-size: 12px;
            flex: 1;
        }

        .folder-main {
            flex: 1;
            display: flex;
            border-top: 1px solid #CCC;
        }

        .folder-sidebar {
            width: 180px;
            background-color: #ECE9D8;
            border-right: 1px solid #D8D2BD;
            padding: 10px 0;
        }

        .folder-sidebar-section {
            margin-bottom: 10px;
        }

        .folder-sidebar-header {
            font-size: 12px;
            font-weight: bold;
            color: #003399;
            padding: 5px 10px;
            background-color: #D8D2BD;
            margin-bottom: 5px;
        }

        .folder-sidebar-item {
            display: flex;
            align-items: center;
            padding: 3px 10px;
            cursor: pointer;
            font-size: 12px;
        }

        .folder-sidebar-item:hover {
            background-color: #D8D2BD;
        }

        .folder-sidebar-emoji {
            margin-right: 5px;
            font-size: 16px;
        }

        .folder-content {
            flex: 1;
            background-color: white;
            padding: 10px;
            overflow: auto;
        }

        .folder-file {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            width: 80px;
            margin: 5px;
            padding: 5px;
            cursor: pointer;
        }

        .folder-file:hover {
            background-color: #E8F1FC;
        }

        .folder-file-emoji {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .folder-file-name {
            font-size: 11px;
            text-align: center;
            word-break: break-word;
        }

        .folder-statusbar {
            height: 22px;
            background-color: #ECE9D8;
            border-top: 1px solid #D8D2BD;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 11px;
        }

        /* Vinyl Player Window Styles */
        .vinyl-window {
            top: 40%;
            left: 40%;
            width: 900px;
            height: 520px;
            background-color: #121212;
        }

        .vinyl-container {
            display: flex;
            width: 100%;
            height: 470px;
        }

        .player-container {
            position: relative;
            width: 600px;
            height: 400px;
            margin: 10px;
            perspective: 1200px;
        }
        
        .turntable {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }
        
        .player-base {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #222;
            transform: translateZ(-10px);
            border-radius: 10px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            border: 2px solid #333;
        }
        
        .platter {
            position: absolute;
            width: 300px;
            height: 300px;
            background-color: #111;
            border-radius: 50%;
            top: 50px;
            left: 150px;
            transform: translateZ(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        .record {
            position: absolute;
            width: 280px;
            height: 280px;
            background: 
                radial-gradient(circle at center, 
                    #000 0%, 
                    #000 38%, 
                    #333 38.5%, 
                    #333 39.5%, 
                    #000 40%, 
                    #000 42%, 
                    #333 42.5%, 
                    #333 43.5%, 
                    #000 44%, 
                    #000 46%, 
                    #333 46.5%, 
                    #333 47.5%, 
                    #000 48%, 
                    #000 50%, 
                    #333 50.5%, 
                    #333 51.5%, 
                    #000 52%, 
                    #000 54%, 
                    #333 54.5%, 
                    #333 55.5%, 
                    #000 56%,
                    #000 100%);
            border-radius: 50%;
            top: 10px;
            left: 10px;
            animation: rotate 5s linear infinite paused;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
        }
        
        .record.playing {
            animation-play-state: running;
        }
        
        .record-label {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            top: 90px;
            left: 90px;
            background-size: cover;
            background-position: center;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }
        
        .record-center {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #888;
            border-radius: 50%;
            top: 130px;
            left: 130px;
            transform: translateZ(7px);
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.8);
        }
        
        .tonearm-base {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #444;
            border-radius: 50%;
            top: 70px;
            right: 100px;
            transform: translateZ(15px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);
        }
        
        .tonearm {
            position: absolute;
            width: 180px;
            height: 10px;
            background-color: #555;
            top: 95px;
            right: 100px;
            transform-origin: right center;
            transform: rotate(-30deg) translateZ(17px);
            transition: transform 1s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3);
        }
        
        .tonearm.playing {
            transform: rotate(15deg) translateZ(17px);
        }
        
        .cartridge {
            position: absolute;
            width: 20px;
            height: 15px;
            background-color: #333;
            left: 0;
            top: -5px;
            transform: translateZ(1px);
        }
        
        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }
        
        .control-button {
            width: 50px;
            height: 50px;
            background-color: #333;
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            transition: all 0.2s ease;
        }
        
        .control-button:hover {
            background-color: #444;
            transform: translateY(-2px);
        }
        
        .control-button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .play-button {
            background-color: #00a651;
        }
        
        .album-display {
            position: absolute;
            width: 200px;
            height: 200px;
            top: 50px;
            left: -200px;
            perspective: 800px;
        }
        
        .album-cover {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
            transform: rotateY(20deg);
            transition: transform 0.5s ease;
        }
        
        .album-cover:hover {
            transform: rotateY(0deg);
        }
        
        .album-info {
            position: absolute;
            bottom: 50px;
            left: -200px;
            width: 200px;
            text-align: center;
            color: white;
        }
        
        .album-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .album-artist {
            font-size: 14px;
            color: #aaa;
        }
        
        .volume-control {
            position: absolute;
            bottom: 50px;
            right: 50px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            color: white;
        }
        
        .volume-slider {
            appearance: none;
            width: 100px;
            height: 5px;
            background: #555;
            outline: none;
            transform: rotate(-90deg);
            margin: 20px 0;
        }
        
        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 15px;
            height: 15px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .volume-label {
            font-size: 12px;
            color: #aaa;
        }
        
        /* Lyrics Panel Styles */
        .lyrics-panel {
            width: 280px;
            height: 450px;
            background-color: #1a1a1a;
            border-radius: 10px;
            margin: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
        }
        
        .lyrics-header {
            height: 40px;
            background-color: #222;
            display: flex;
            align-items: center;
            padding: 0 15px;
            border-bottom: 1px solid #333;
        }
        
        .lyrics-title {
            color: white;
            font-size: 16px;
            font-weight: bold;
        }
        
        .lyrics-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            color: #ddd;
            font-size: 14px;
            line-height: 1.6;
            scrollbar-width: thin;
            scrollbar-color: #444 #1a1a1a;
        }
        
        .lyrics-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .lyrics-content::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        .lyrics-content::-webkit-scrollbar-thumb {
            background-color: #444;
            border-radius: 6px;
            border: 2px solid #1a1a1a;
        }
        
        .lyrics-line {
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }
        
        .lyrics-line.active {
            color: #00a651;
            font-weight: bold;
        }
        
        .lyrics-timestamp {
            color: #666;
            font-size: 12px;
            margin-right: 5px;
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        /* Make windows draggable */
        .window.dragging {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="desktop">
        <div class="desktop-icons">
            <div class="icon">
                <a href="https://dinkybeat.github.io/yots.html" target="_blank">
                    <div class="emoji">üëÑ</div>
                    <div class="icon-text">'Tis The Year of the Snitch</div>
                </a>
            </div>
            
            <div class="icon">
                <a href="https://dinkybeat.github.io/broadcast.html" target="_blank">
                    <div class="emoji">üéôÔ∏è</div>
                    <div class="icon-text">Humane Radio Broadcast</div>
                </a>
            </div>

            <div class="icon" id="vinylIcon">
                <div class="emoji">üíø</div>
                <div class="icon-text">Music Player</div>
            </div>
        </div>

        <!-- Folder Window -->
        <div class="window folder-window" id="folderWindow">
            <div class="titlebar" id="folderTitlebar">
                <div class="title">
                    <div class="title-emoji">üìÅ</div>
                    <span>My Documents</span>
                </div>
                <div class="window-controls">
                    <div class="window-button">_</div>
                    <div class="window-button">‚ñ°</div>
                    <div class="window-button close-button" onclick="closeWindow('folderWindow')">‚úï</div>
                </div>
            </div>
            <div class="folder-toolbar">
                <div class="folder-toolbar-section">
                    <div class="folder-toolbar-button">
                        <div class="folder-toolbar-emoji">‚óÄ</div>
                        <span>Back</span>
                    </div>
                    <div class="folder-toolbar-button">
                        <div class="folder-toolbar-emoji">‚ñ∂</div>
                        <span>Forward</span>
                    </div>
                </div>
                <div class="folder-toolbar-section">
                    <div class="folder-toolbar-button">
                        <div class="folder-toolbar-emoji">üîç</div>
                        <span>Search</span>
                    </div>
                    <div class="folder-toolbar-button">
                        <div class="folder-toolbar-emoji">üìÅ</div>
                        <span>Folders</span>
                    </div>
                </div>
            </div>
            <div class="folder-addressbar">
                <div class="folder-addressbar-label">Address:</div>
                <div class="folder-addressbar-path">C:\Documents and Settings\Administrator\My Documents</div>
            </div>
            <div class="folder-main">
                <div class="folder-sidebar">
                    <div class="folder-sidebar-section">
                        <div class="folder-sidebar-header">System Tasks</div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üíª</div>
                            <span>My Computer</span>
                        </div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üìÇ</div>
                            <span>My Documents</span>
                        </div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üñºÔ∏è</div>
                            <span>My Pictures</span>
                        </div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üéµ</div>
                            <span>My Music</span>
                        </div>
                    </div>
                    <div class="folder-sidebar-section">
                        <div class="folder-sidebar-header">Other Places</div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üè†</div>
                            <span>Desktop</span>
                        </div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üåê</div>
                            <span>Shared Documents</span>
                        </div>
                        <div class="folder-sidebar-item">
                            <div class="folder-sidebar-emoji">üóëÔ∏è</div>
                            <span>Recycle Bin</span>
                        </div>
                    </div>
                </div>
                <div class="folder-content">
                    <!-- Text files with data attributes for notepad content -->
                    <div class="folder-file" data-filename="About Me.txt" data-content="Your system. Your rules. PanesOS is still in development. Check back soon!">
                        <div class="folder-file-emoji">üìÑ</div>
                        <div class="folder-file-name">About Me.txt</div>
                    </div>
                    <div class="folder-file" data-filename="Projects.txt" data-content="Check back soon!">
                        <div class="folder-file-emoji">üìÑ</div>
                        <div class="folder-file-name">Projects.txt</div>
                    </div>
                    
                    <div class="folder-file" data-filename="Contact Info.txt" data-content="Out of sight. Out of mind.">
                        <div class="folder-file-emoji">üìÑ</div>
                        <div class="folder-file-name">Contact Info.txt</div>
                    </div>
                </div>
            </div>
            <div class="folder-statusbar">
                3 items
            </div>
        </div>

        <!-- Vinyl Player Window -->
        <div class="window vinyl-window" id="vinylWindow">
            <div class="titlebar" id="vinylTitlebar">
                <div class="title">
                    <div class="title-emoji">üíø</div>
                    <span>Vinyl Player - Death Grips</span>
                </div>
                <div class="window-controls">
                    <div class="window-button">_</div>
                    <div class="window-button">‚ñ°</div>
                    <div class="window-button close-button" onclick="closeWindow('vinylWindow')">‚úï</div>
                </div>
            </div>
            <div class="vinyl-container">
                <div class="player-container">
                    <div class="turntable" id="turntable">
                        <div class="player-base"></div>
                        <div class="platter">
                            <div class="record" id="record">
                                <div class="record-label" style="background-image: url('https://i.discogs.com/WMrtONp2OVLav9NCqkz-lx0bmtycv7cVwIqSbL0aevo/rs:fit/g:sm/q:90/h:600/w:598/czM6Ly9kaXNjb2dz/LWRhdGFiYXNlLWlt/YWdlcy9SLTI2OTcw/MTg1LTE2OTcyNjAx/NzItMTQyNi5qcGVn.jpeg');"></div>
                            </div>
                            <div class="record-center"></div>
                        </div>
                        <div class="tonearm-base"></div>
                        <div class="tonearm" id="tonearm">
                            <div class="cartridge"></div>
                        </div>
                        <div class="controls">
                            <button class="control-button play-button" id="playButton">‚ñ∂</button>
                            <button class="control-button" id="stopButton">‚ñ†</button>
                        </div>
                        <div class="volume-control">
                            <span class="volume-label">Volume</span>
                            <input type="range" min="0" max="100" value="80" class="volume-slider" id="volumeSlider">
                        </div>
                    </div>
                    <div class="album-display">
                        <div class="album-cover" style="background-image: url('https://i.discogs.com/WMrtONp2OVLav9NCqkz-lx0bmtycv7cVwIqSbL0aevo/rs:fit/g:sm/q:90/h:600/w:598/czM6Ly9kaXNjb2dz/LWRhdGFiYXNlLWlt/YWdlcy9SLTI2OTcw/MTg1LTE2OTcyNjAx/NzItMTQyNi5qcGVn.jpeg');"></div>
                    </div>
                    <div class="album-info">
                        <div class="album-title">Beware</div>
                        <div class="album-artist">Death Grips</div>
                    </div>
                </div>
                
                <!-- Lyrics Panel -->
                <div class="lyrics-panel">
                    <div class="lyrics-header">
                        <div class="lyrics-title">Beware - Lyrics</div>
                    </div>
                    <div class="lyrics-content" id="lyricsContent">
                        <!-- Lyrics lines will be added by JavaScript -->
                    </div>
                </div>
            </div>
            <audio id="audioPlayer" src="https://dinkybeat.github.io/media/audio/Beware.mp3" preload="auto"></audio>
        </div>
    </div>
    
    <div class="taskbar">
        <div class="start-button">
            <div class="start-emoji">ü™ü</div>
            <span class="start-text">Start</span>
        </div>
        
        <div class="taskbar-divider"></div>
        
        <div class="quick-launch">
            <div class="quick-launch-icon">üåê</div>
            <div class="quick-launch-icon" id="folderButton">üìÅ</div>
            <div class="quick-launch-icon" id="notepadButton">üìù</div>
            <div class="quick-launch-icon" id="vinylButton">üíø</div>
        </div>
        
        <div class="taskbar-divider"></div>
        
        <div class="taskbar-apps">
            <!-- Taskbar apps will be added dynamically -->
        </div>
        
        <div class="taskbar-spacer"></div>
        
        <div class="system-tray">
            <div class="tray-emoji">üîä</div>
            <div class="tray-emoji">üì∂</div>
            <span class="time" id="clock">13:45</span>
        </div>
    </div>

    <script>
        // Update the clock
        function updateClock() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            
            hours = hours % 12;
            hours = hours ? hours : 12; // the hour '0' should be '12'
            
            document.getElementById('clock').textContent = `${hours}:${minutes} ${ampm}`;
        }
        
        // Update the clock every minute
        updateClock();
        setInterval(updateClock, 60000);
        
        // Make icons selectable
        const icons = document.querySelectorAll('.icon');
        icons.forEach(icon => {
            icon.addEventListener('click', function() {
                // Remove selected class from all icons
                icons.forEach(i => i.classList.remove('selected'));
                // Add selected class to clicked icon
                this.classList.add('selected');
            });
        });
        
        // Double-click handling for icons
        icons.forEach(icon => {
            let clickCount = 0;
            let clickTimer = null;
            
            icon.addEventListener('click', function(e) {
                // Don't trigger double-click handling if clicking on an anchor (let the link work)
                if (e.target.tagName === 'A' || e.target.closest('a')) {
                    return;
                }
                
                clickCount++;
                
                if (clickCount === 1) {
                    clickTimer = setTimeout(function() {
                        clickCount = 0;
                    }, 300);
                } else if (clickCount === 2) {
                    clearTimeout(clickTimer);
                    clickCount = 0;
                    
                    // If this is the vinyl icon, open the vinyl player
                    if (this.id === 'vinylIcon') {
                        openWindow('vinylWindow');
                        return;
                    }
                    
                    // Find the link in this icon and navigate to it
                    const link = this.querySelector('a');
                    if (link) {
                        window.open(link.href, link.target || '_self');
                    }
                }
            });
        });

        // General window management
        function openWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.style.display = 'flex';
                
                // Add window app to taskbar if it doesn't exist
                const windowType = windowId.replace('Window', '');
                const existingWindowApp = document.querySelector(`.taskbar-app.${windowType}-app`);
                
                if (!existingWindowApp) {
                    const windowApp = document.createElement('div');
                    windowApp.className = `taskbar-app ${windowType}-app`;
                    
                    let appName = 'Application';
                    let emoji = 'üìÑ';
                    
                    if (windowType === 'folder') {
                        appName = 'My Documents';
                        emoji = 'üìÅ';
                    } else if (windowType === 'vinyl') {
                        appName = 'Vinyl Player';
                        emoji = 'üíø';
                    } else if (windowType === 'notepad') {
                        appName = 'Notepad';
                        emoji = 'üìù';
                    }
                    
                    windowApp.innerHTML = `<div class="app-emoji">${emoji}</div><span>${appName}</span>`;
                    document.querySelector('.taskbar-apps').appendChild(windowApp);
                    
                    // Click on taskbar app to toggle window
                    windowApp.addEventListener('click', function() {
                        if (window.style.display === 'none') {
                            window.style.display = 'flex';
                        } else {
                            window.style.display = 'none';
                        }
                    });
                }
            }
        }

        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.style.display = 'none';
                
                // Remove window app from taskbar
                const windowType = windowId.replace('Window', '');
                const windowApp = document.querySelector(`.taskbar-app.${windowType}-app`);
                if (windowApp) {
                    windowApp.remove();
                }
                
                // If this is the vinyl player, pause the music
                if (windowId === 'vinylWindow') {
                    pauseRecord();
                }
            }
        }

        // Make all windows draggable
        const windowTitlebars = document.querySelectorAll('.window .titlebar');
        windowTitlebars.forEach(titlebar => {
            const window = titlebar.parentElement;
            
            titlebar.addEventListener('mousedown', function(e) {
                if (e.target.closest('.window-controls')) {
                    return; // Don't start dragging if clicking window controls
                }
                
                const isDragging = true;
                window.classList.add('dragging');
                
                // Get the current position of the window
                const rect = window.getBoundingClientRect();
                
                // Calculate the offset between the mouse position and the top-left corner of the window
                const offsetX = e.clientX - rect.left;
                const offsetY = e.clientY - rect.top;
                
                function moveWindow(moveEvent) {
                    // Set the position of the window based on the mouse position and offset
                    window.style.left = (moveEvent.clientX - offsetX) + 'px';
                    window.style.top = (moveEvent.clientY - offsetY) + 'px';
                    window.style.transform = 'none'; // Remove the translate transform
                }
                
                function stopDragging() {
                    window.classList.remove('dragging');
                    document.removeEventListener('mousemove', moveWindow);
                    document.removeEventListener('mouseup', stopDragging);
                }
                
                document.addEventListener('mousemove', moveWindow);
                document.addEventListener('mouseup', stopDragging);
            });
        });

        // Folder window functionality
        const folderButton = document.getElementById('folderButton');
        folderButton.addEventListener('click', function() {
            openWindow('folderWindow');
        });

        // Vinyl player functionality
        const vinylButton = document.getElementById('vinylButton');
        const vinylIcon = document.getElementById('vinylIcon');
        const record = document.getElementById('record');
        const tonearm = document.getElementById('tonearm');
        const playButton = document.getElementById('playButton');
        const stopButton = document.getElementById('stopButton');
        const volumeSlider = document.getElementById('volumeSlider');
        const audioPlayer = document.getElementById('audioPlayer');
        const lyricsContent = document.getElementById('lyricsContent');
        
        let isPlaying = false;
        let currentLyricIndex = -1;
        
        // Set initial volume
        audioPlayer.volume = volumeSlider.value / 100;

        // Load the lyrics
        const lyrics = [
            { time: 0, text: "I close my eyes and seize it" },
            { time: 2, text: "I clench my fists and beat it" },
            { time: 4, text: "I light my torch and burn it" },
            { time: 6, text: "I am the beast I worship" },
            { time: 8, text: "I close my eyes and seize it" },
            { time: 10, text: "I clench my fists and beat it" },
            { time: 12, text: "I light my torch and burn it" },
            { time: 14, text: "I am the beast I worship" },
            // Rest of lyrics with timestamps relative to the 66-second mark
        ];
        
        // Populate lyrics panel
        function populateLyrics() {
            lyrics.forEach((line, index) => {
                const lineElement = document.createElement('div');
                lineElement.className = 'lyrics-line';
                lineElement.dataset.index = index;
                lineElement.innerHTML = `<span class="lyrics-timestamp">${formatTime(line.time)}</span> ${line.text}`;
                lyricsContent.appendChild(lineElement);
            });
        }
        
        // Format time as mm:ss, adding 66 seconds to show actual song time
        function formatTime(seconds) {
            // Add 52 seconds to get the actual song time
            const totalSeconds = seconds + 66;
            const min = Math.floor(totalSeconds / 60);
            const sec = Math.floor(totalSeconds % 60).toString().padStart(2, '0');
            return `${min}:${sec}`;
        }
        
        // Update the active lyrics based on current time
        function updateLyrics() {
            if (!isPlaying) return;
            
            const currentTime = audioPlayer.currentTime;
            
            // Don't show any lyrics before 66 seconds
            if (currentTime < 66) {
                // Clear any highlighted lyrics
                document.querySelectorAll('.lyrics-line').forEach(line => {
                    line.classList.remove('active');
                });
                currentLyricIndex = -1;
                return;
            }
            
            // Adjust current time to be relative to the 52-second mark
            const adjustedTime = currentTime - 66;
            
            // Find the current lyric based on the adjusted time
            let foundIndex = -1;
            for (let i = lyrics.length - 1; i >= 0; i--) {
                if (adjustedTime >= lyrics[i].time) {
                    foundIndex = i;
                    break;
                }
            }
            
            // If we found a new current lyric
            if (foundIndex !== currentLyricIndex) {
                // Remove active class from all lines
                document.querySelectorAll('.lyrics-line').forEach(line => {
                    line.classList.remove('active');
                });
                
                // Add active class to current line
                if (foundIndex >= 0) {
                    const activeLine = document.querySelector(`.lyrics-line[data-index="${foundIndex}"]`);
                    if (activeLine) {
                        activeLine.classList.add('active');
                        
                        // Scroll to make active line visible
                        activeLine.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
                
                currentLyricIndex = foundIndex;
            }
        }

        // Vinyl player buttons
        vinylButton.addEventListener('click', function() {
            openWindow('vinylWindow');
        });

        // Play/Pause functionality
        playButton.addEventListener('click', function() {
            if (isPlaying) {
                pauseRecord();
            } else {
                playRecord();
            }
        });

        // Stop functionality
        stopButton.addEventListener('click', function() {
            stopRecord();
        });

        // Volume control
        volumeSlider.addEventListener('input', function() {
            audioPlayer.volume = this.value / 100;
        });

        function playRecord() {
            record.classList.add('playing');
            tonearm.classList.add('playing');
            playButton.innerHTML = '‚ùö‚ùö';
            audioPlayer.play();
            isPlaying = true;
            
            // Start updating lyrics
            updateLyricsInterval = setInterval(updateLyrics, 100);
        }

        function pauseRecord() {
            record.classList.remove('playing');
            tonearm.classList.remove('playing');
            playButton.innerHTML = '‚ñ∂';
            audioPlayer.pause();
            isPlaying = false;
            
            // Stop updating lyrics
            clearInterval(updateLyricsInterval);
        }

        function stopRecord() {
            pauseRecord();
            audioPlayer.currentTime = 0;
            
            // Reset lyrics display
            document.querySelectorAll('.lyrics-line').forEach(line => {
                line.classList.remove('active');
            });
            currentLyricIndex = -1;
            
            // Scroll lyrics to top
            lyricsContent.scrollTop = 0;
        }

        // Make the turntable interactive with mouse movements
        const turntable = document.querySelector('.turntable');
        const playerContainer = document.querySelector('.player-container');
        let isDragging = false;
        let startX, startY, startRotateX = 0, startRotateY = 0;
        let currentRotateX = 20, currentRotateY = 0;

        // Initialize the 3D perspective
        turntable.style.transform = `rotateX(${currentRotateX}deg) rotateY(${currentRotateY}deg)`;
        
        playerContainer.addEventListener('mousedown', function(e) {
            if (e.target.closest('.controls') || e.target.closest('.volume-control')) {
                return;
            }
            
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            startRotateX = currentRotateX;
            startRotateY = currentRotateY;
            playerContainer.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;
            
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            currentRotateY = startRotateY + deltaX * 0.2;
            currentRotateX = startRotateX - deltaY * 0.2;
            
            // Limit the rotation angles
            currentRotateX = Math.max(-30, Math.min(40, currentRotateX));
            currentRotateY = Math.max(-30, Math.min(30, currentRotateY));
            
            turntable.style.transform = `rotateX(${currentRotateX}deg) rotateY(${currentRotateY}deg)`;
        });

        document.addEventListener('mouseup', function() {
            isDragging = false;
            playerContainer.style.cursor = 'grab';
        });

        // Handle audio ending
        audioPlayer.addEventListener('ended', function() {
            stopRecord();
        });

        // Notepad quick launch
        const notepadButton = document.getElementById('notepadButton');
        notepadButton.addEventListener('click', function() {
            openNotepad('Untitled', '');
        });

        // Function to open notepad with specific file
        function openNotepad(fileName, fileContent) {
            window.open(`notepad.html?file=${encodeURIComponent(fileName)}&content=${encodeURIComponent(fileContent)}`, '_blank', 'width=600,height=400');
            
            // Add notepad app to taskbar
            const existingNotepadApps = document.querySelectorAll(`.taskbar-app.notepad-app[data-filename="${fileName}"]`);
            if (existingNotepadApps.length === 0) {
                const notepadApp = document.createElement('div');
                notepadApp.className = 'taskbar-app notepad-app';
                notepadApp.setAttribute('data-filename', fileName);
                notepadApp.innerHTML = `<div class="app-emoji">üìù</div><span>${fileName}</span>`;
                document.querySelector('.taskbar-apps').appendChild(notepadApp);
            }
        }

        // Add click handlers for folder content
        const folderFiles = document.querySelectorAll('.folder-file');
        folderFiles.forEach(file => {
            file.addEventListener('click', function() {
                // Remove selected class from all files
                folderFiles.forEach(f => f.style.backgroundColor = '');
                // Add selected class to clicked file
                this.style.backgroundColor = '#CCE8FF';
            });
            
            // Double-click handling for folder content
            let fileClickCount = 0;
            let fileClickTimer = null;
            
            file.addEventListener('click', function() {
                fileClickCount++;
                
                if (fileClickCount === 1) {
                    fileClickTimer = setTimeout(function() {
                        fileClickCount = 0;
                    }, 300);
                } else if (fileClickCount === 2) {
                    clearTimeout(fileClickTimer);
                    fileClickCount = 0;
                    
                    const fileName = this.querySelector('.folder-file-name').textContent;
                    
                    // Check if this is a text file
                    if (fileName.endsWith('.txt')) {
                        // Get data from data attributes
                        const fileTitle = this.getAttribute('data-filename') || fileName;
                        const fileContent = this.getAttribute('data-content') || '';
                        
                        // Open notepad with the file content
                        openNotepad(fileTitle, fileContent);
                    } else {
                        alert(`Opening ${fileName}`);
                    }
                }
            });
        });

        // Initialize the vinyl player
        populateLyrics();
        let updateLyricsInterval;
    </script>
</body>
</html>